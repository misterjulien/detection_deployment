# api.github.com/repos/{owner}/{repo}/commits/{commit_sha}
# The file details it gives are just the new and updated files.

{
    'sha': 'f6a23742a3521153ca69a128e94432eb125870e4', 
    'node_id': 'C_kwDOKMnWhdoAKGY2YTIzNzQyYTM1MjExNTNjYTY5YTEyOGU5NDQzMmViMTI1ODcwZTQ', 
    'commit': {
        'author': {
            'name': 'misterjulien', 
            'email': 'misterjulien@gmail.com', 
            'date': '2023-08-31T11:34:02Z'
        }, 
        'committer': {
            'name': 'GitHub', 
            'email': 'noreply@github.com', 
            'date': '2023-08-31T11:34:02Z'
        }, 
        'message': 'Merge pull request #1 from misterjulien/branch1\n\nBranch1', 
        'tree': {
            'sha': 'b701fed1a2bdc79d20c9acb858634bd42d739255', 
            'url': 'https://api.github.com/repos/misterjulien/detection_library_poc/git/trees/b701fed1a2bdc79d20c9acb858634bd42d739255'
        }, 
            'url': 'https://api.github.com/repos/misterjulien/detection_library_poc/git/commits/f6a23742a3521153ca69a128e94432eb125870e4', 
            'comment_count': 0, 'verification': {
            'verified': True, 
            'reason': 'valid', 
            'signature': '-----BEGIN PGP SIGNATURE-----\n\nwsBcBebgiqQ2xF0uh\n6SddRZR76Xa8K2q3g95K8H3g/99J1YdTO625uaRdLwuW7outAFUk6+WxjD8r8BJS\n9s6nMmp9+zolaoFeoEpLwS2AC0UzPC3lquloluUe2uITn7pAFJmZ+/GQ4XwxiHxj\ntc+tNqGYGTZbxqmQKG/ywTpPGniyn+JjL7X0/4ds5cfi3/g10KjACwLstfmckGc=\n=fTVf\n-----END PGP SIGNATURE-----\n', 
            'payload': 'tree b701fed1a2bdc79d20c9acb858634bd42d739255\nparent b901ca16ba553087e3bd9eadd44a9a9602172644\nparent d0f5b2d57df60f5910f4ac5cb61e35b551a66951\nauthor misterjulien <misterjulien@gmail.com> 1693481642 -0400\ncommitter GitHub <noreply@github.com> 1693481642 -0400\n\nMerge pull request #1 from misterjulien/branch1\n\nBranch1'
        }
    }, 
    'url': 'https://api.github.com/repos/misterjulien/detection_library_poc/commits/f6a23742a3521153ca69a128e94432eb125870e4', 
    'html_url': 'https://github.com/misterjulien/detection_library_poc/commit/f6a23742a3521153ca69a128e94432eb125870e4', 
    'comments_url': 'https://api.github.com/repos/misterjulien/detection_library_poc/commits/f6a23742a3521153ca69a128e94432eb125870e4/comments', 
    'author': {
        'login': 'misterjulien', 
        'id': 1956879, 
        'node_id': 'MDQ6VXNlcjE5NTY4Nzk=', 
        'avatar_url': 'https://avatars.githubusercontent.com/u/1956879?v=4', 
        'gravatar_id': '', 
        'url': 'https://api.github.com/users/misterjulien', 
        'html_url': 'https://github.com/misterjulien', 
        'followers_url': 'https://api.github.com/users/misterjulien/followers', 
        'following_url': 'https://api.github.com/users/misterjulien/following{/other_user}', 
        'gists_url': 'https://api.github.com/users/misterjulien/gists{/gist_id}', 
        'starred_url': 'https://api.github.com/users/misterjulien/starred{/owner}{/repo}', 
        'subscriptions_url': 'https://api.github.com/users/misterjulien/subscriptions', 
        'organizations_url': 'https://api.github.com/users/misterjulien/orgs', 
        'repos_url': 'https://api.github.com/users/misterjulien/repos', 
        'events_url': 'https://api.github.com/users/misterjulien/events{/privacy}', 
        'received_events_url': 'https://api.github.com/users/misterjulien/received_events', 
        'type': 'User', 
        'site_admin': False
    }, 
    'committer': {
        'login': 'web-flow', 
        'id': 19864447, 
        'node_id': 'MDQ6VXNlcjE5ODY0NDQ3', 
        'avatar_url': 'https://avatars.githubusercontent.com/u/19864447?v=4', 
        'gravatar_id': '', 
        'url': 'https://api.github.com/users/web-flow', 
        'html_url': 'https://github.com/web-flow', 
        'followers_url': 'https://api.github.com/users/web-flow/followers', 
        'following_url': 'https://api.github.com/users/web-flow/following{/other_user}', 
        'gists_url': 'https://api.github.com/users/web-flow/gists{/gist_id}', 
        'starred_url': 'https://api.github.com/users/web-flow/starred{/owner}{/repo}', 
        'subscriptions_url': 'https://api.github.com/users/web-flow/subscriptions', 
        'organizations_url': 'https://api.github.com/users/web-flow/orgs', 
        'repos_url': 'https://api.github.com/users/web-flow/repos', 
        'events_url': 'https://api.github.com/users/web-flow/events{/privacy}', 
        'received_events_url': 'https://api.github.com/users/web-flow/received_events', 
        'type': 'User', 
        'site_admin': False
    }, 
    'parents': [
        {
            'sha': 'b901ca16ba553087e3bd9eadd44a9a9602172644', 
            'url': 'https://api.github.com/repos/misterjulien/detection_library_poc/commits/b901ca16ba553087e3bd9eadd44a9a9602172644', 
            'html_url': 'https://github.com/misterjulien/detection_library_poc/commit/b901ca16ba553087e3bd9eadd44a9a9602172644'
        }, 
        {
            'sha': 'd0f5b2d57df60f5910f4ac5cb61e35b551a66951', 
            'url': 'https://api.github.com/repos/misterjulien/detection_library_poc/commits/d0f5b2d57df60f5910f4ac5cb61e35b551a66951', 
            'html_url': 'https://github.com/misterjulien/detection_library_poc/commit/d0f5b2d57df60f5910f4ac5cb61e35b551a66951'
        }
    ], 
    'stats': {
        'total': 46, 
        'additions': 46, 
        'deletions': 0
    }, 
    'files': [
        {
            'sha': '00040dcf648a79566a590b4c7859c7c4dfb34b29', 
            'filename': 'rules/cloud/aws/aws_config_disable_recording.yml', 
            'status': 'added', 
            'additions': 23, 
            'deletions': 0, 
            'changes': 23, 
            'blob_url': 'https://github.com/misterjulien/detection_library_poc/blob/f6a23742a3521153ca69a128e94432eb125870e4/rules%2Fcloud%2Faws%2Faws_config_disable_recording.yml', 
            'raw_url': 'https://github.com/misterjulien/detection_library_poc/raw/f6a23742a3521153ca69a128e94432eb125870e4/rules%2Fcloud%2Faws%2Faws_config_disable_recording.yml', 
            'contents_url': 'https://api.github.com/repos/misterjulien/detection_library_poc/contents/rules%2Fcloud%2Faws%2Faws_config_disable_recording.yml?ref=f6a23742a3521153ca69a128e94432eb125870e4', 
            'patch': '@@ -0,0 +1,23 @@\n+title: AWS Config Disabling Channel/Recorder\n+id: 07330162-dba1-4746-8121-a9647d49d297\n+status: test\n+description: Detects AWS Config Service disabling (taken from sigma/rules/cloud/aws/aws_config_disable_recording.yml)\n+author: vitaliy0x1\n+date: 2020/01/21\n+modified: 2022/10/09\n+tags:\n+    - attack.defense_evasion\n+    - attack.t1562.001\n+logsource:\n+    product: aws\n+    service: cloudtrail\n+detection:\n+    selection_source:\n+        eventSource: config.amazonaws.com\n+        eventName:\n+            - DeleteDeliveryChannel\n+            - StopConfigurationRecorder\n+    condition: selection_source\n+falsepositives:\n+    - Valid change in AWS Config Service\n+level: high'
        }, 
        {
            'sha': 'fc4f7caf4b9ebb5f1f107eaab8f8832b0c6ecc59', 
            'filename': 'rules/cloud/aws/aws_delete_identity.yml', 
            'status': 'added', 
            'additions': 23, 
            'deletions': 0, 
            'changes': 23, 
            'blob_url': 'https://github.com/misterjulien/detection_library_poc/blob/f6a23742a3521153ca69a128e94432eb125870e4/rules%2Fcloud%2Faws%2Faws_delete_identity.yml', 
            'raw_url': 'https://github.com/misterjulien/detection_library_poc/raw/f6a23742a3521153ca69a128e94432eb125870e4/rules%2Fcloud%2Faws%2Faws_delete_identity.yml', 
            'contents_url': 'https://api.github.com/repos/misterjulien/detection_library_poc/contents/rules%2Fcloud%2Faws%2Faws_delete_identity.yml?ref=f6a23742a3521153ca69a128e94432eb125870e4', 
            'patch': '@@ -0,0 +1,23 @@\n+title: SES Identity Has Been Deleted\n+id: 20f754db-d025-4a8f-9d74-e0037e999a9a\n+status: experimental\n+description: Detects an instance of an SES identity being deleted via the "DeleteIdentity" event. This may be an indicator of an adversary removing the account that carried out suspicious or malicious activities\n+references:\n+    - https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/\n+author: Janantha Marasinghe\n+date: 2022/12/13\n+modified: 2022/12/28\n+tags:\n+    - attack.defense_evasion\n+    - attack.t1070\n+logsource:\n+    product: aws\n+    service: cloudtrail\n+detection:\n+    selection:\n+        eventSource: \'ses.amazonaws.com\'\n+        eventName: \'DeleteIdentity\'\n+    condition: selection\n+falsepositives:\n+    - Unknown\n+level: medium'
        }
    ]
}